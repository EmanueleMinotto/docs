<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Entity translator - Elcodi Documentation</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Elcodi Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../quick-start/">Quick start</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../reference/attribute/">Attribute</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/banner/">Banner</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/cart-coupon/">Cart coupon</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/cart/">Cart</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/comment/">Comment</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/configuration/">Configuration</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/coupon/">Coupon</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/sitemap/">Sitemap</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../components/attribute/">Attribute</a>
                            </li>
                        
                            <li >
                                <a href="../../components/entity-translator/">Entity translator</a>
                            </li>
                        
                            <li >
                                <a href="../../components/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../components/menu/">Menu</a>
                            </li>
                        
                            <li >
                                <a href="../../components/state-transition-machine/">State transition machine</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Bundles <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../attribute/">Attribute</a>
                            </li>
                        
                            <li class="active">
                                <a href="./">Entity translator</a>
                            </li>
                        
                            <li >
                                <a href="../">Home</a>
                            </li>
                        
                            <li >
                                <a href="../menu/">Menu</a>
                            </li>
                        
                            <li >
                                <a href="../sitemap/">Sitemap</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Book <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../book/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../book/standards/classes/">Classes</a>
                            </li>
                        
                            <li >
                                <a href="../../book/standards/code/">Code</a>
                            </li>
                        
                            <li >
                                <a href="../../book/standards/dependency-injection/">Dependency injection</a>
                            </li>
                        
                            <li >
                                <a href="../../book/standards/packages-structure/">Packages structure</a>
                            </li>
                        
                            <li >
                                <a href="../../book/workflows/cart/">Cart</a>
                            </li>
                        
                            <li >
                                <a href="../../book/bundles/extensions/">Extensions</a>
                            </li>
                        
                            <li >
                                <a href="../../book/bundles/plugins/">Plugins</a>
                            </li>
                        
                            <li >
                                <a href="../../book/bundles/templates/">Templates</a>
                            </li>
                        
                            <li >
                                <a href="../../book/philosophy/elcodi/">Elcodi</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../cookbook/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/caveats/running-test-suite/">Running test suite</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/installation/install-dependent-bundles/">Install dependent bundles</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/overwrite/overwrite-a-entity/">Overwrite a entity</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/overwrite/overwrite-a-parameter/">Overwrite a parameter</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/overwrite/overwrite-a-service/">Overwrite a service</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/implementation/implement-a-controller-and-a-command/">Implement a controller and a command</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/implementation/implement-a-factory/">Implement a factory</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/implementation/implement-a-form-type/">Implement a form type</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/implementation/implement-a-repository/">Implement a repository</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/implementation/implement-an-entity/">Implement an entity</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../attribute/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#entitytranslator">EntityTranslator</a></li>
        
            <li><a href="#about-your-model">About your model</a></li>
        
            <li><a href="#configuring-the-entity-translator">Configuring the entity translator</a></li>
        
            <li><a href="#saving-translations">Saving translations</a></li>
        
            <li><a href="#translating-an-entity">Translating an entity</a></li>
        
            <li><a href="#translations-in-forms">Translations in forms</a></li>
        
            <li><a href="#custom-form-views">Custom form views</a></li>
        
            <li><a href="#automatic-entity-translation">Automatic entity translation</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="entitytranslator">EntityTranslator</h1>
<p>This Bundle provides a Entity Translation layer to your project, in order to
make your entities translatable respecting the integrity of your domain.</p>
<p>For that, this implementation hides all the translation model behind a soft
layer, so your business model is never modified because of the translation
needs.</p>
<h2 id="about-your-model">About your model</h2>
<p>Easy and simple. Let's work with a simple entity mapped in Doctrine.</p>
<pre><code class="php">/**
 * Class Product
 *
 * @ORM\Entity
 */
class Product
{
    /**
     * @var string
     *
     * @ORM\Id
     * @ORM\Column
     * @ORM\GeneratedValue
     *
     * id
     */
    protected $id;

    /**
     * @var string
     *
     * @ORM\Column(type=&quot;string&quot;)
     *
     * Name
     */
    protected $name;

    /**
     * @var string
     *
     * @ORM\Column(type=&quot;text&quot;)
     *
     * Description
     */
    protected $description;
}
</code></pre>

<p>This example will assume that you want to make both fields, name and
description, translatable. To make it happen, we can simply remove  the mapping
of both fields, to rely the responsibility of translation to the Translator
component.</p>
<pre><code class="php">/**
 * Class Product
 *
 * @ORM\Entity
 */
class Product
{
    /**
     * @var string
     *
     * @ORM\Id
     * @ORM\Column
     * @ORM\GeneratedValue
     *
     * id
     */
    protected $id;

    /**
     * @var string
     *
     * Name
     */
    protected $name;

    /**
     * @var string
     *
     * Description
     */
    protected $description;
}
</code></pre>

<p>Now your installation will see the Product as a simple id. Why is this good for
us? This example uses Annotations, and we highly recommend to define all your
mapping configuration using <code>yml</code> so you can easily decouple your model
implementation (entities) and your mapping configuration (Product.orm.yml) and
disable some fields for mapping with the same entity implementation.</p>
<h2 id="configuring-the-entity-translator">Configuring the entity translator</h2>
<p>Now, we need to configure the translator. You need to define what entities and
fields you allow the engine to manage. Let's see the configuration for this
example.</p>
<pre><code class="yml">elcodi_entity_translator:
    configuration:
        My\Bundle\Entity\Product:
            alias: product

            // idGetter, by default, getId
            idGetter: getId
            fields:
                name:
                    // getter, by default, getName in this case
                    // setter, by default, setName in this case
                    getter: getName
                    setter: setName
                description:
                    getter: getDescription
                    setter: setDescription
</code></pre>

<p>This is the basic definition of the Product translation. You can see that there
is come specific information set by default, so indeed, this configuration could
be defined as well that way</p>
<pre><code class="yml">elcodi_entity_translator:
    configuration:
        My\Bundle\Entity\Product:
            alias: product
            fields:
                name: ~
                description: ~
</code></pre>

<p>You can use Interfaces as well, so in that case, to ensure that the
configuration will be still valid even if you change the Product implementation,
you can use an Interface for that</p>
<pre><code class="yml">elcodi_entity_translator:
    configuration:
        My\Bundle\Entity\Interfaces\ProductInterface:
            alias: product
            fields:
                name: ~
                description: ~
</code></pre>

<h2 id="saving-translations">Saving translations</h2>
<p>Do you want to translate an entity? Great, let's do that! You can easily manage
your translation using the entity translator service.</p>
<pre><code class="php">$entityTranslator = $this
    -&gt;container
    -&gt;get('elcodi.entity_translator');
</code></pre>

<p>Once you have the service instance, you can set your entity translations in a
very simple way. In this example, let's create a new entity, let's save it into
database and let's translate it.</p>
<pre><code class="php">$product = new Product();
$product-&gt;setId(1);

$entityTranslator-&gt;save($product, [
    'es' =&gt; [
        'name' =&gt; 'el nombre',
        'description' =&gt; 'la descripción',
    ],
    'en' =&gt; [
        'name' =&gt; 'the name',
        'description' =&gt; 'the description',
        'anotherfield' =&gt; 'some value',
    ],
]);
</code></pre>

<h2 id="translating-an-entity">Translating an entity</h2>
<p>So, your entity is translated? Well, let's load the translations of an entity.
You only need the entity and the language you want it to be translated to.</p>
<pre><code class="php">$product = $this
    -&gt;get('doctrine.orm.entity_manager')
    -&gt;find(1);

$entityTranslator-&gt;translate($product, 'en');
</code></pre>

<p>And that's it. Your product is now translated to english, and because both
fields, name and description, are not mapped anymore, you could flush the entity
manager and no information would be saved.</p>
<h2 id="translations-in-forms">Translations in forms</h2>
<p>This is maybe the most important feature of this Bundle. How can we handle all
this stuff in our forms? Very simple. We don't have to change our form
definition but only adapt it to add an EventSubscriber.</p>
<p>Let's see an example.</p>
<pre><code class="php">use Elcodi\Component\EntityTranslator\EventListener\Traits\EntityTranslatableFormTrait;
use Symfony\Component\Form\AbstractType;

/**
 * Class ProductType
 */
class ProductType extends AbstractType
{
    use EntityTranslatableFormTrait;

    /**
     * Buildform function
     *
     * @param FormBuilderInterface $builder the formBuilder
     * @param array                $options the options for this form
     */
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            -&gt;add('name', 'text', [
                'required' =&gt; true,
                'label'    =&gt; 'name',
            ])
            -&gt;add('description', 'textarea', [
                'required' =&gt; false,
                'label'    =&gt; 'description',
            ]);

        $builder-&gt;addEventSubscriber($this-&gt;getEntityTranslatorFormEventListener());
    }

    /**
     * Return unique name for this form
     *
     * @return string
     */
    public function getName()
    {
        return 'form_type_product';
    }
}
</code></pre>

<p>As you can see, there are only two changes in this formType. First one is that
you must add this trait in order to add a protected variable and two methods.
The second change is that you must add the EventSubscriber the way is shown in
the example.</p>
<p>Because now the formType has some dependencies, you must define this formType as
a service in the dependency injection configuration.</p>
<pre><code class="yml">services:
    form_type.product:
        class: My\Namespace\Form\Type\ProductType
        calls:
            - [setEntityTranslatorFormEventListener, [@elcodi.entity_translator_form_event_listener]]
        tags:
            - { name: form.type, alias: form_type_product }
</code></pre>

<p>And that's it. Try to render your form, treating name and description like they
were normal fields and what you will see is that, instead of rendering a text
input field and a Textarea, three of each will be rendered.</p>
<h2 id="custom-form-views">Custom form views</h2>
<p>You can easily customize the way of rendering these fields by adding some format
into the rendering of <code>translatable_field</code>. You can find more information in
chapter - <a href="http://symfony.com/doc/current/cookbook/form/form_customization.html#what-are-form-themes">What are Form Themes?</a></p>
<h2 id="automatic-entity-translation">Automatic entity translation</h2>
<p>You can enable the automatic translation of all loaded entities by enabling the
related configuration flag <code>auto_translate</code>.</p>
<pre><code class="yml">elcodi_entity_translation:
    auto_translate: true
</code></pre>

<p>By default this value is true. If true, every time you load a new entity from
Doctrine than is defined as translatable (a field is included in the
configuration), that entity will be translated using the current locale.</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>

        <!--
        MkDocs version  : 0.12.1
        Docs Build Date : 2015-05-26 14:27:05.543472
        -->
    </body>
</html>