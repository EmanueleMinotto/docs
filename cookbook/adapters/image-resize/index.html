<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://www.elcodi.io/cookbook/adapters/image-resize/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Image resize - Elcodi Documentation</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">

        <link href="../../../css/elcodi.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../.."><img src="../../../img/elcodi.png" height="30" /></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                
                
                
                    
                        <li >
                            <a href="../../../quick-start/">Quick start</a>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Book <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../../book/cart-architecture/">Cart architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/category-architecture/">Category architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/commands/">Commands</a>
</li>

                            
                                
<li >
    <a href="../../../book/coupon-architecture/">Coupon architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/dictionary/">Dictionary</a>
</li>

                            
                                
<li >
    <a href="../../../book/emails/">Emails</a>
</li>

                            
                                
<li >
    <a href="../../../book/events/">Events</a>
</li>

                            
                                
<li >
    <a href="../../../book/features/">Features</a>
</li>

                            
                                
<li >
    <a href="../../../book/">Home</a>
</li>

                            
                                
<li >
    <a href="../../../book/payments/">Payments</a>
</li>

                            
                                
<li >
    <a href="../../../book/philosophy/">Philosophy</a>
</li>

                            
                                
<li >
    <a href="../../../book/plugins/">Plugins</a>
</li>

                            
                                
<li >
    <a href="../../../book/processes/">Processes</a>
</li>

                            
                                
<li >
    <a href="../../../book/product-architecture/">Product architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/pull-requests/">Pull requests</a>
</li>

                            
                                
<li >
    <a href="../../../book/roadmap/">Roadmap</a>
</li>

                            
                                
<li >
    <a href="../../../book/running-test-suite/">Running test suite</a>
</li>

                            
                                
<li >
    <a href="../../../book/shipping/">Shipping</a>
</li>

                            
                                
<li >
    <a href="../../../book/standards/">Standards</a>
</li>

                            
                                
<li >
    <a href="../../../book/templates/">Templates</a>
</li>

                            
                                
<li >
    <a href="../../../book/translate-elcodi/">Translate elcodi</a>
</li>

                            
                                
<li >
    <a href="../../../book/vagrant-quick-start/">Vagrant quick start</a>
</li>

                            
                                
<li >
    <a href="../../../book/what-is-elcodi/">What is elcodi</a>
</li>

                            
                                
<li >
    <a href="../../../book/why-elcodi/">Why elcodi</a>
</li>

                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown active">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../">Home</a>
</li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Installation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../installation/install-a-plugin/">Install a plugin</a>
</li>

        
            
<li >
    <a href="../../installation/install-dependent-bundles/">Install dependent bundles</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Overwrite</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../overwrite/overwrite-a-parameter/">Overwrite a parameter</a>
</li>

        
            
<li >
    <a href="../../overwrite/overwrite-a-service/">Overwrite a service</a>
</li>

        
            
<li >
    <a href="../../overwrite/overwrite-an-entity/">Overwrite an entity</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Deprecation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../deprecation/deprecate-a-method/">Deprecate a method</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Adapters</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../currency-rates-populator/">Currency rates populator</a>
</li>

        
            
<li class="active">
    <a href="./">Image resize</a>
</li>

        
            
<li >
    <a href="../location-loader/">Location loader</a>
</li>

        
            
<li >
    <a href="../location-populator/">Location populator</a>
</li>

        
            
<li >
    <a href="../location-provider/">Location provider</a>
</li>

        
            
<li >
    <a href="../metric-bucket/">Metric bucket</a>
</li>

        
            
<li >
    <a href="../related-purchasables-provider/">Related purchasables provider</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Workflow</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../workflow/create-automatic-coupon/">Create automatic coupon</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Usage</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../usage/elcodi-watermark/">Elcodi watermark</a>
</li>

        
            
<li >
    <a href="../../usage/referrer-domain/">Referrer domain</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Implementation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../implementation/implement-a-collector/">Implement a collector</a>
</li>

        
            
<li >
    <a href="../../implementation/implement-a-controller-and-a-command/">Implement a controller and a command</a>
</li>

        
            
<li >
    <a href="../../implementation/implement-a-factory/">Implement a factory</a>
</li>

        
            
<li >
    <a href="../../implementation/implement-a-form-type/">Implement a form type</a>
</li>

        
            
<li >
    <a href="../../implementation/implement-a-repository/">Implement a repository</a>
</li>

        
            
<li >
    <a href="../../implementation/implement-an-entity/">Implement an entity</a>
</li>

        
            
<li >
    <a href="../../implementation/implement-an-event-listener/">Implement an event listener</a>
</li>

        
    </ul>
  </li>

                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Component <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../../component/entity-translator/">Entity translator</a>
</li>

                            
                                
<li >
    <a href="../../../component/">Home</a>
</li>

                            
                                
<li >
    <a href="../../../component/media/">Media</a>
</li>

                            
                                
<li >
    <a href="../../../component/menu/">Menu</a>
</li>

                            
                                
<li >
    <a href="../../../component/metrics/">Metrics</a>
</li>

                            
                                
<li >
    <a href="../../../component/sitemap/">Sitemap</a>
</li>

                            
                                
<li >
    <a href="../../../component/state-transition-machine/">State transition machine</a>
</li>

                            
                                
<li >
    <a href="../../../component/template/">Template</a>
</li>

                            
                            </ul>
                        </li>
                    
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../currency-rates-populator/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../location-loader/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/elcodi/docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#how-to-add-a-new-image-resize-adapter">How to add a new Image Resize adapter</a></li>
        
            <li><a href="#scenario">Scenario</a></li>
        
            <li><a href="#solution">Solution</a></li>
        
            <li><a href="#resize-types">Resize types</a></li>
        
            <li><a href="#used-adapter">Used Adapter</a></li>
        
            <li><a href="#adapters">Adapters</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="how-to-add-a-new-image-resize-adapter">How to add a new Image Resize adapter<a class="headerlink" href="#how-to-add-a-new-image-resize-adapter" title="Permanent link"> #</a></h1>
<p>Elcodi is served with a simple but very useful built-in image server. One of
the most important actions this server is intended for is resizing images.</p>
<h2 id="scenario">Scenario<a class="headerlink" href="#scenario" title="Permanent link"> #</a></h2>
<p>You need your application to be deployed to a server with PHP GD, but you want
to use another image resize engine, for example an external API.</p>
<p>Elcodi provides you a set of limited adapters for image resizing, so we should
implement this new adapter. Elcodi provides you a simple, fast and amazing way
to do it without many pain</p>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link"> #</a></h2>
<p>You can create your own image resize engine by adding a new adapter. By default,
Elcodi is built with an implementation using the PHP GD Extension (you will
probably find this extension already installed with your regular PHP
distribution). This adapter can be easily replaced by creating a new class
implementing <code>CurrencyExchangeRatesProviderAdapterInterface</code>.</p>
<pre><code class="php">&lt;?php

namespace Elcodi\Component\Media\Adapter\Resizer\Interfaces;

use Elcodi\Component\Media\ElcodiMediaImageResizeTypes;

/**
 * Interface ResizerAdapterInterface
 */
interface ResizeAdapterInterface
{
    /**
     * Interface for resize implementations
     *
     * @param string  $imageData Image Data
     * @param integer $height    Height value
     * @param integer $width     Width value
     * @param integer $type      Type
     *
     * @return string Resized image data
     */
    public function resize(
        $imageData,
        $height,
        $width,
        $type = ElcodiMediaImageResizeTypes::FORCE_MEASURES
    );
}
</code></pre>

<p>Then, you need to define your class as a service.</p>
<pre><code class="yml">services:

    #
    # My image resizer adapter
    #
    my_image_resizer_adapter:
        class: My\Image\Resizer\Adapter
</code></pre>

<p>And finally you need to expose your adapter implementation as the used by the
framework when resizing an existing image. You can do that by configuring the
MediaBundle and setting your new service id.</p>
<pre><code class="yml">elcodi_media:
    images:
        resize:
            client: my_image_resizer_adapter
</code></pre>

<p>Now, everytime an image needs to be resized, you will see your new adapter in
action.</p>
<h2 id="resize-types">Resize types<a class="headerlink" href="#resize-types" title="Permanent link"> #</a></h2>
<p>Elcodi resize adapter must complain 6 different resize types. Each type is
defined using the constants placed in <code>ElcodiMediaImageResizeTypes</code>.</p>
<pre><code class="php">namespace Elcodi\Component\Media;

/**
 * Class ElcodiMediaImageResizeTypes
 */
final class ElcodiMediaImageResizeTypes
{
    /**
     * @var integer
     *
     * Do not resize the image
     */
    const NO_RESIZE = 0;

    /**
     * @var integer
     *
     * Resize mode FORCE_MEASURES sets the image to the desired size.
     * DOES NOT preserve original aspect ratio.
     * Best for fixed size images like banners
     */
    const FORCE_MEASURES = 1;

    /**
     * @var integer
     *
     * Resize mode INSET sets the image to the desired size.
     * Preserves original aspect ratio so it might not fill the box.
     * Best for large thumbnails
     */
    const INSET = 2;

    /**
     * @var integer
     *
     * Resize mode INSET_FILL_WHITE sets the image to the desired size.
     * Preserves original aspect ratio and adds white color to the background in order to fill the box.
     * Best for small thumbnails
     */
    const INSET_FILL_WHITE = 3;

    /**
     * @var integer
     *
     * Outbound resizing
     */
    const OUTBOUNDS_FILL_WHITE = 4;

    /**
     * @var integer
     *
     * Resize mode 5 sets the image to the desired size.
     * Preserves original aspect ratio and crops image for only get this area.
     */
    const OUTBOUND_CROP = 5;
}
</code></pre>

<p>As you can see in the adapter interface, by default this resize must force
measures.</p>
<h2 id="used-adapter">Used Adapter<a class="headerlink" href="#used-adapter" title="Permanent link"> #</a></h2>
<p>The adapter used by the Dependency Injection is the one aliased with the name
<code>elcodi.media_resize_adapter</code>.</p>
<p>If you want to change the adapter, the only thing you must do is overwrite the
Media Bundle configuration in your project, by adding this in your
<code>/app/config/config_local.yml</code> file.</p>
<pre><code class="yaml">elcodi_media:
    image:
        resize:
            adapter: elcodi.media_resize_adapter.gd
</code></pre>

<h2 id="adapters">Adapters<a class="headerlink" href="#adapters" title="Permanent link"> #</a></h2>
<p>These are our adapters included in the Core of the application. If you have
implemented another adapter and you think that can be interesting to share it,
then you can create a pull request with your work. We will appreciate it.</p>
<h3 id="gd-extension-adapter">GD Extension Adapter<a class="headerlink" href="#gd-extension-adapter" title="Permanent link"> #</a></h3>
<ul>
<li>Namespace - Elcodi\Component\Media\Adapter\Resizer\GDResizeAdapter</li>
<li>DI name - <code>elcodi.media_resize_adapter.gd</code></li>
</ul>
<p>This extension doesn't need any extra installation</p>
<h3 id="imagemagick-adapter">Imagemagick Adapter<a class="headerlink" href="#imagemagick-adapter" title="Permanent link"> #</a></h3>
<ul>
<li>Namespace - Elcodi\Component\Media\Adapter\Resizer\ImageMagickResizeAdapter</li>
<li>DI name - <code>elcodi.media_resize_adapter.imagemagick</code></li>
</ul>
<p>For more info just visit their <a href="http://php.net/manual/en/imagick.setup.php">installation page</a></p>
<blockquote>
<p>On the installation step you will be asked to provide the Imagick installation
path. Ensure to configure the parameter imagick_convert_bin_path right</p>
</blockquote>
<p>This adapter may need some configuration. This is the reference. Feel free to
overwrite these values in your project.</p>
<pre><code class="yaml">elcodi_media:
    image:
        resize:
            converter_bin_path: /usr/bin/convert
            converter_default_profile: /usr/share/color/icc/colord/sRGB.icc
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
                <p>Copyright © 2014/2015 <a href="http://www.elcodi.io">Elcodi</a>. All rights reserved.</p>
            
        </footer>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
