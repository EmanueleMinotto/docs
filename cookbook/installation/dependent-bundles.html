<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elcodi Documentation</title>

    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic'
          rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="http://elcodi.io/docs/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="http://elcodi.io/docs/css/theme-fixes.css" type="text/css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
</head>
<body class="wy-body-for-nav">

    <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
            <div class="wy-side-nav-search">
                <a href="http://elcodi.io/docs/" class="fa fa-home"> Elcodi Documentation</a>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/quick-start.html">
                                Quick Start
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/book/index.html">
                                The book
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/cookbook/index.html">
                                The Cookbook
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/components/index.html">
                                The Components
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/reference/index.html">
                                Reference
                            </a>
                        </li>
                                    </ul>
            </div>
            &nbsp;
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                        <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="http://elcodi.io/docs/">Elcodi Documentation</a>
            </nav>


                        <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="main" class="document">
                        <h1>How to Install dependent Bundles</h1>
<p>This chapter is not only to show how to install a Dependent Bundle in Elcodi
environment, but to show how to do it properly.</p>
<h3>Package dependencies</h3>
<p>All Bundles in Elcodi follow the same installation strategy than Symfony
standard packages. Elcodi uses composer for package dependencies, so each
standalone Elcodi repository comes with a properly configured <code>composer.json</code>
file.</p>
<p>But when we talk about Bundles in Symfony, defining the dependencies in the
composer file is not enough. The Kernel will instantiate only the Bundles you
define in <code>AppKernel.php</code> file, ignoring the real dependencies this Bundle has.</p>
<p>So, regarding this real problem, Elcodi has developed some business logic in
order to solve this problem.</p>
<p>First of all, let's take a look at a simple Symfony Bundle class.</p>
<pre><code class="language-php">/**
 * ElcodiCartBundle Bundle
 */
class ElcodiCartBundle extends Bundle
{
}</code></pre>
<p>Maybe this Bundle need the instantiation of another bundle (previously added in
the composer definition), but is not defined anywhere. So... let's do that.</p>
<p>The first step is to define a set of Bundle namespaces that must be instanced
before this Bundle.</p>
<p>All dependent Bundles will be instanced before this Bundle. This is because a
Bundle should be able to override another Bundle definition, and Symfony has in
most cases a <strong>Last defined wins</strong> strategy.</p>
<pre><code class="language-php">use Symfony\Component\HttpKernel\Bundle\Bundle;
use Elcodi\Bundle\CoreBundle\Interfaces\DependentBundleInterface;

/**
 * ElcodiCartBundle Bundle
 */
class ElcodiCartBundle extends Bundle implements DependentBundleInterface
{
    /**
     * Create instance of current bundle, and return dependent bundle namespaces
     *
     * @return array Bundle instances
     */
    public static function getBundleDependencies()
    {
        return [
            'Elcodi\Bundle\UserBundle\ElcodiUserBundle',
            'Elcodi\Bundle\ProductBundle\ElcodiProductBundle',
            'Elcodi\Bundle\CurrencyBundle\ElcodiCurrencyBundle',
            'Elcodi\Bundle\StateTransitionMachineBundle\ElcodiStateTransitionMachineBundle',
            'Elcodi\Bundle\ShippingBundle\ElcodiShippingBundle',
            'Elcodi\Bundle\ConfigurationBundle\ElcodiConfigurationBundle',
            'Elcodi\Bundle\CoreBundle\ElcodiCoreBundle',
        ];
    }
}</code></pre>
<p>So, what else? Is that enough?</p>
<p>Then, in order to make it happen, we must use a specific method in our
<code>AppKernel</code> class, using a Trait provided by <code>ElcodiCoreBundle</code>.</p>
<pre><code class="language-php">use Elcodi\Bundle\CoreBundle\Traits\BundleDependenciesResolver;
use Elcodi\Bundle\TestCommonBundle\Functional\Abstracts\AbstractElcodiKernel;

/**
 * Class AppKernel
 */
class AppKernel extends AbstractElcodiKernel
{
    use BundleDependenciesResolver;

    /**
     * Register application bundles
     *
     * @return array Array of bundles instances
     */
    public function registerBundles()
    {
        return $this-&gt;getBundleInstances([
            '\Elcodi\Bundle\CartBundle\ElcodiCartBundle',
        ]);
    }
}</code></pre>
<p>And that's it. You kernel will instance your <code>ElcodiCartBundle</code> bundle and all
its dependencies.</p>
<blockquote>
<p>This method will work as well, even if the Bundle has no dependencies or is
not extending DependentBundleInterface.</p>
</blockquote>
<h3>Using dependencies in your project</h3>
<p>If you want to use this classes and methods in your Symfony project, you don't
really need to instance <code>ElcodiCoreBundle</code> because you will not need any kind
of Dependency Injection definition.</p>
<p>You only need to add <code>elcodi/core-bundle</code> in your package requirements and then
use the Interface and the Trait as is shown in this CookBook entry.</p>
                    </div>

                    <footer>
                        <hr/>
                                                    <div role="contentinfo">
                                <p>
                                    Find Elcodi Documentation on <a href="https://github.com/elcodi/docs">GitHub</a>.
                                </p>
                            </div>
                                                Built with <a href="http://couscous.io/">Couscous</a> using a <a href="https://github.com/CouscousPHP/Template-ReadTheDocs">theme</a> based on <a href="https://readthedocs.org/">Read the Docs</a>.
                    </footer>

                </div>
            </div>

        </section>

    </div>

    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script src="http://elcodi.io/docs/js/theme.js"></script>

    <script>
        $(function() {
            // Syntax highlighting
            hljs.initHighlightingOnLoad();
        });
    </script>

</body>
</html>
