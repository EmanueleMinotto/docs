<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elcodi Documentation</title>

    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic'
          rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="http://elcodi.io/docs/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="http://elcodi.io/docs/css/theme-fixes.css" type="text/css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
</head>
<body class="wy-body-for-nav">

    <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
            <div class="wy-side-nav-search">
                <a href="http://elcodi.io/docs/" class="fa fa-home"> Elcodi Documentation</a>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/quick-start.html">
                                Quick Start
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/book/index.html">
                                The book
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/cookbook/index.html">
                                The Cookbook
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/components/index.html">
                                The Components
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://elcodi.io/docs/reference/index.html">
                                Reference
                            </a>
                        </li>
                                    </ul>
            </div>
            &nbsp;
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                        <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="http://elcodi.io/docs/">Elcodi Documentation</a>
            </nav>


                        <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="main" class="document">
                        <h1>How to Overwrite an Entity</h1>
<p>Each project is completely different, right? Elcodi is just one approach to an
specific e-commerce problem, but one of our goals is to provide a way for
overwriting absolutely everything.</p>
<p>In this document we will show you how to properly overwrite any default entity
implementation with your own.</p>
<h3>Extending or Implementing</h3>
<p>Each entity has its own interface. It means that if you want to build your own
<code>Cart</code>, for example, your new implementation will need to implement the existing
Cart interface, in that case,
<code>Elcodi\Component\Cart\Entity\Interfaces\CartInterface</code>.</p>
<pre><code class="language-php">use Elcodi\Component\Cart\Entity\Interfaces\CartInterface;

/**
 * New Cart implementation
 */
class NewCart implements CartInterface
{

}    </code></pre>
<p>You can also create a new entity extending the default Cart implementation (at this point
your new entity will be implementing this interface by default). The advantage is
that you don't need to implement all the methods of the interface, but just overwrite
those that you want to change.</p>
<pre><code class="language-php">use Elcodi\Component\Cart\Entity\Cart;

/**
 * New Cart implementation
 */
class NewCart extends Cart
{

}    </code></pre>
<p>Both ways are valid depending on your implementation needs.</p>
<h3>Using this new implementation</h3>
<p>Once your new entity is implemented, you need to tell your application
about your new implementation.</p>
<p>Elcodi works with a project called
<a href="https://github.com/mmoreram/SimpleDoctrineMapping">SimpleDoctrineMapping</a>. This
library enables each bundle to specify how its entities must be treated inside
the Symfony installation, instead of letting Doctrine decide this stuff using
<code>auto_mapping=true</code>.</p>
<p>Each Elcodi Bundle uses this library, so you can overwrite this information
through each Bundle configuration. Let's see how CartBundle allows the user to
define this information by exposing its configuration.</p>
<pre><code class="language-yaml">elcodi_cart:

    mapping:
        cart:
            # Cart entity implementing CartInterface
            class: Elcodi\Component\Cart\Entity\Cart
            # Doctrine mapping file for this entity
            mapping_file: '@ElcodiCartBundle/Resources/config/doctrine/Cart.orm.yml'
            # Doctrine manager name
            manager: default
            # Is this entity enabled?
            enabled: true</code></pre>
<p>If you don't define anything, then these values are injected as default
configuration values in CartBundle, so this is the way of overwriting the
definition to start using our new Cart implementation.</p>
<pre><code class="language-yaml">elcodi_cart:

    mapping:
        cart:
            # Cart entity implementing CartInterface
            class: My\New\Bundle\Entity\NewCart</code></pre>
<p>And that's enough.</p>
<h3>Changing the mapping file</h3>
<p>Once you have changed your entity, or just using the default entity
implementation, maybe you want to change the way the entity is mapped in your
database.</p>
<pre><code class="language-yaml">elcodi_cart:

    mapping:
        cart:
            # Doctrine mapping file for this entity
            mapping_file: '@MyNewBundle/Resources/config/doctrine/Cart.orm.yml'</code></pre>
<p>In Elcodi we are actually using <code>yml</code> files for such definition, but you can use
both <code>yml</code> and <code>xml</code> files.</p>
<pre><code class="language-yaml">elcodi_cart:

    mapping:
        cart:
            # Doctrine mapping file for this entity
            mapping_file: '@MyNewBundle/Resources/config/doctrine/Cart.orm.xml'</code></pre>
<p>The result will be the same, and the system will detect the file extension.</p>
<h3>Using another Entity Manager</h3>
<p>By default, all entities are managed by the default entity manager. You can
change this behavior just overwriting this configuration value. The selected entity
manager must exist in your Doctrine ORM definition.</p>
<pre><code class="language-yaml">elcodi_cart:

    mapping:
        cart:
            # Doctrine manager name
            manager: another_entity_manager</code></pre>
<p>Take into account that related entities should share the same entity manager. For
example, in this example, because <code>Cart</code> has several <code>CartLine</code> instances, it
would be not possible to have both tables managed separately by two different
managers.</p>
<h3>Disabling an Entity</h3>
<p>Maybe you want to disable a specific entity. The most used strategy would be not
to use this entity, even if the table is created, but we strongly think that
your model must be considered an essential part of your implementation, so you
can disable an entity with a single line.</p>
<pre><code class="language-yaml">elcodi_cart:

    mapping:
        cart:
            enabled: false</code></pre>
                    </div>

                    <footer>
                        <hr/>
                                                    <div role="contentinfo">
                                <p>
                                    Find Elcodi Documentation on <a href="https://github.com/elcodi/docs">GitHub</a>.
                                </p>
                            </div>
                                                Built with <a href="http://couscous.io/">Couscous</a> using a <a href="https://github.com/CouscousPHP/Template-ReadTheDocs">theme</a> based on <a href="https://readthedocs.org/">Read the Docs</a>.
                    </footer>

                </div>
            </div>

        </section>

    </div>

    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script src="http://elcodi.io/docs/js/theme.js"></script>

    <script>
        $(function() {
            // Syntax highlighting
            hljs.initHighlightingOnLoad();
        });
    </script>

</body>
</html>
