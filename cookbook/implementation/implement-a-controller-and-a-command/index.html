<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://www.elcodi.io/cookbook/implementation/implement-a-controller-and-a-command/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Implement a controller and a command - Elcodi Documentation</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">

        <link href="../../../css/elcodi.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../.."><img src="../../../img/elcodi.png" height="30" /></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                
                
                
                    
                        <li >
                            <a href="../../../quick-start/">Quick start</a>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Book <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../../book/cart-architecture/">Cart architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/category-architecture/">Category architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/commands/">Commands</a>
</li>

                            
                                
<li >
    <a href="../../../book/coupon-architecture/">Coupon architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/dictionary/">Dictionary</a>
</li>

                            
                                
<li >
    <a href="../../../book/emails/">Emails</a>
</li>

                            
                                
<li >
    <a href="../../../book/events/">Events</a>
</li>

                            
                                
<li >
    <a href="../../../book/">Home</a>
</li>

                            
                                
<li >
    <a href="../../../book/payments/">Payments</a>
</li>

                            
                                
<li >
    <a href="../../../book/philosophy/">Philosophy</a>
</li>

                            
                                
<li >
    <a href="../../../book/plugins/">Plugins</a>
</li>

                            
                                
<li >
    <a href="../../../book/processes/">Processes</a>
</li>

                            
                                
<li >
    <a href="../../../book/product-architecture/">Product architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/pull-requests/">Pull requests</a>
</li>

                            
                                
<li >
    <a href="../../../book/roadmap/">Roadmap</a>
</li>

                            
                                
<li >
    <a href="../../../book/running-test-suite/">Running test suite</a>
</li>

                            
                                
<li >
    <a href="../../../book/shipping/">Shipping</a>
</li>

                            
                                
<li >
    <a href="../../../book/standards/">Standards</a>
</li>

                            
                                
<li >
    <a href="../../../book/templates/">Templates</a>
</li>

                            
                                
<li >
    <a href="../../../book/translate-elcodi/">Translate elcodi</a>
</li>

                            
                                
<li >
    <a href="../../../book/vagrant-quick-start/">Vagrant quick start</a>
</li>

                            
                                
<li >
    <a href="../../../book/what-is-elcodi/">What is elcodi</a>
</li>

                            
                                
<li >
    <a href="../../../book/why-elcodi/">Why elcodi</a>
</li>

                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown active">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../">Home</a>
</li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Installation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../installation/install-a-plugin/">Install a plugin</a>
</li>

        
            
<li >
    <a href="../../installation/install-dependent-bundles/">Install dependent bundles</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Overwrite</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../overwrite/overwrite-a-parameter/">Overwrite a parameter</a>
</li>

        
            
<li >
    <a href="../../overwrite/overwrite-a-service/">Overwrite a service</a>
</li>

        
            
<li >
    <a href="../../overwrite/overwrite-an-entity/">Overwrite an entity</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Deprecation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../deprecation/deprecate-a-method/">Deprecate a method</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Adapters</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../adapters/currency-rates-populator/">Currency rates populator</a>
</li>

        
            
<li >
    <a href="../../adapters/image-resize/">Image resize</a>
</li>

        
            
<li >
    <a href="../../adapters/location-loader/">Location loader</a>
</li>

        
            
<li >
    <a href="../../adapters/location-populator/">Location populator</a>
</li>

        
            
<li >
    <a href="../../adapters/location-provider/">Location provider</a>
</li>

        
            
<li >
    <a href="../../adapters/metric-bucket/">Metric bucket</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Workflow</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../workflow/create-automatic-coupon/">Create automatic coupon</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Usage</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../usage/elcodi-watermark/">Elcodi watermark</a>
</li>

        
            
<li >
    <a href="../../usage/referrer-domain/">Referrer domain</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Implementation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../implement-a-collector/">Implement a collector</a>
</li>

        
            
<li class="active">
    <a href="./">Implement a controller and a command</a>
</li>

        
            
<li >
    <a href="../implement-a-factory/">Implement a factory</a>
</li>

        
            
<li >
    <a href="../implement-a-form-type/">Implement a form type</a>
</li>

        
            
<li >
    <a href="../implement-a-repository/">Implement a repository</a>
</li>

        
            
<li >
    <a href="../implement-an-entity/">Implement an entity</a>
</li>

        
            
<li >
    <a href="../implement-an-event-listener/">Implement an event listener</a>
</li>

        
    </ul>
  </li>

                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Component <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../../component/entity-translator/">Entity translator</a>
</li>

                            
                                
<li >
    <a href="../../../component/">Home</a>
</li>

                            
                                
<li >
    <a href="../../../component/media/">Media</a>
</li>

                            
                                
<li >
    <a href="../../../component/menu/">Menu</a>
</li>

                            
                                
<li >
    <a href="../../../component/metrics/">Metrics</a>
</li>

                            
                                
<li >
    <a href="../../../component/sitemap/">Sitemap</a>
</li>

                            
                                
<li >
    <a href="../../../component/state-transition-machine/">State transition machine</a>
</li>

                            
                                
<li >
    <a href="../../../component/template/">Template</a>
</li>

                            
                            </ul>
                        </li>
                    
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../implement-a-collector/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../implement-a-factory/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/elcodi/docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#how-to-implement-a-controller-or-a-command">How to Implement a Controller or a Command</a></li>
        
            <li><a href="#scenario">Scenario</a></li>
        
            <li><a href="#solution">Solution</a></li>
        
            <li><a href="#related-links">Related links</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="how-to-implement-a-controller-or-a-command">How to Implement a Controller or a Command<a class="headerlink" href="#how-to-implement-a-controller-or-a-command" title="Permanent link"> #</a></h1>
<p>Controllers and Commands in Elcodi are exactly the same than Controllers and 
Commands in Symfony. No difference between them. But in Elcodi we have a strong
philosophy about how to create them in order to be valid or usable in the Open
Source environment.</p>
<h2 id="scenario">Scenario<a class="headerlink" href="#scenario" title="Permanent link"> #</a></h2>
<p>We have a Bamboo-based application in our server and we need to create a new 
entry-point for our application, for example a new Controller to manage orders
from specific users, in order to create special newsletters and increase the
number of orders per customer.</p>
<p>Controllers and Commands are designed and implemented following a simple but
specific way. We need to know how both classes are created in Elcodi in order to
follow the same philosophy in all places.</p>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link"> #</a></h2>
<p>Following this specific way, we need to know the differences between creating
Controllers and Commands as services, or simply rely to the framework the way
these classes are auto-discovered.</p>
<h3 id="services-in-elcodi">Services in Elcodi<a class="headerlink" href="#services-in-elcodi" title="Permanent link"> #</a></h3>
<p>All Elcodi Controllers and Commands are defined as services. This is because we
are <em>Overwriting Oriented Programming</em> and we have in mind that every single
implementation sensible to be changed between projects must be easily 
customized.</p>
<p>In Symfony, and because Dependency Injection definition has a very well documented
overwriting strategy, we have decided that everything must be defined as a 
service.</p>
<p>We have a convention about how a Controller and a Command must be registered in
your DI container</p>
<pre><code class="yaml">elcodi.controller.image_upload
elcodi.command.populate_currency_rates
</code></pre>

<p>Of course, and because it should only depend on the Symfony Components, but never
the Symfony Framework nor the FrameworkBundle, both implementations must not extend
Framework classes.</p>
<h3 id="framework-controllers-in-bamboo">Framework Controllers in Bamboo<a class="headerlink" href="#framework-controllers-in-bamboo" title="Permanent link"> #</a></h3>
<p>When you work in Bamboo (or in your project on top of Elcodi Components and 
Bundles) we don't recommend the usage of Controllers and Commands as services.
We think that both implementations are Entry Points and should be Framework
related.</p>
<p>This means that your Controllers or Commands should never have business logic,
and should place all this logic in your service layer.</p>
<p>Having said that, we recommend the usage of <em>FrameworkBundle</em> Controller class to
endow your controllers with easy access to the DI container and a good set of
pre-built methods.</p>
<pre><code class="php">use Symfony\Bundle\FrameworkBundle\Controller\Controller;

/**
 * Cart controllers
 */
class CartController extends Controller
{
}
</code></pre>

<h3 id="framework-commands-in-bamboo">Framework Commands in Bamboo<a class="headerlink" href="#framework-commands-in-bamboo" title="Permanent link"> #</a></h3>
<p>We have the same opinion for Commands and Controllers.</p>
<pre><code class="php">use Symfony\Bundle\FrameworkBundle\Command\ContainerAwareCommand;

/**
 * Cart controllers
 */
class MyCommand extends ContainerAwareCommand
{
}
</code></pre>

<h3 id="annotations-in-bamboo-controllers">Annotations in Bamboo Controllers<a class="headerlink" href="#annotations-in-bamboo-controllers" title="Permanent link"> #</a></h3>
<p>In Bamboo, we use annotations in all our controllers in order to make the code more
understandable and to focus only on business logic. Annotations solve
repetitive things and should be perfectly documented.</p>
<blockquote>
<p>Magic? Yes, of course, same magic than yml readers, than Container
compilation, than service builds... so what?</p>
</blockquote>
<p>For this reason, we are using 
<a href="http://github.com/mmoreram/ControllerExtraBundle">ControllerExtraBundle</a> and
<a href="https://github.com/sensiolabs/SensioFrameworkExtraBundle">SensioFrameworkExtraBundle</a>.</p>
<p>Let's see an example.</p>
<pre><code class="php">use Mmoreram\ControllerExtraBundle\Annotation\Entity as AnnotationEntity;
use Mmoreram\ControllerExtraBundle\Annotation\Form as AnnotationForm;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;

/**
 * Cart controllers
 *
 * @Route(
 *      path = &quot;/cart&quot;,
 * )
 */
class CartController extends Controller
{
    /**
     * Cart view
     *
     * @param FormView      $formView Form view
     * @param CartInterface $cart     Cart
     *
     * @return Response Response
     *
     * @Route(
     *      path = &quot;&quot;,
     *      name = &quot;store_cart_view&quot;,
     *      methods = {&quot;GET&quot;}
     * )
     *
     * @AnnotationEntity(
     *      class = {
     *          &quot;factory&quot; = &quot;elcodi.wrapper.cart&quot;,
     *          &quot;method&quot; = &quot;loadCart&quot;,
     *          &quot;static&quot; = false,
     *      },
     *      name = &quot;cart&quot;
     * )
     * @AnnotationForm(
     *      class = &quot;store_cart_form_type_cart&quot;,
     *      name  = &quot;formView&quot;,
     *      entity = &quot;cart&quot;,
     * )
     */
    public function viewAction(
        FormView $formView,
        CartInterface $cart
    ) {
        // ...

        return $this-&gt;renderTemplate(
            'Pages:cart-view.html.twig',
            [
                // ...
            ]
        );
    }
}
</code></pre>

<p>You can find some documentation of both annotation packages</p>
<ul>
<li><a href="https://github.com/mmoreram/ControllerExtraBundle/blob/master/README.md">ControllerExtraBundle</a></li>
<li><a href="http://symfony.com/doc/current/bundles/SensioFrameworkExtraBundle/index.html">SensioFrameworkExtraBundle</a></li>
</ul>
<p>Please, before using annotations in your project make sure that you know how
they work and how to use them. Read the documentation of both packages and try
to understand their meaning.</p>
<h2 id="related-links">Related links<a class="headerlink" href="#related-links" title="Permanent link"> #</a></h2>
<ul>
<li><a href="http://symfony.com/doc/current/cookbook/controller/service.html">Symfony docs - How to define controllers as services</a></li>
<li><a href="http://symfony.com/doc/current/cookbook/console/commands_as_services.html">Symfony docs - How to define commands as services</a></li>
</ul></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
                <p>Copyright © 2014/2015 <a href="http://www.elcodi.io">Elcodi</a>. All rights reserved.</p>
            
        </footer>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
