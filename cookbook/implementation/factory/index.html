<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Factory - Elcodi Documentation</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">Elcodi Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../../quick-start/">Quick start</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../../reference/attribute/">Attribute</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/banner/">Banner</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/cart-coupon/">Cart coupon</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/cart/">Cart</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/comment/">Comment</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/configuration/">Configuration</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/coupon/">Coupon</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../../reference/sitemap/">Sitemap</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../../components/attribute/">Attribute</a>
                            </li>
                        
                            <li >
                                <a href="../../../components/entityTranslator/">entityTranslator</a>
                            </li>
                        
                            <li >
                                <a href="../../../components/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../../components/menu/">Menu</a>
                            </li>
                        
                            <li >
                                <a href="../../../components/stateTransitionMachine/">stateTransitionMachine</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Bundles <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../../bundles/attribute/">Attribute</a>
                            </li>
                        
                            <li >
                                <a href="../../../bundles/entityTranslator/">entityTranslator</a>
                            </li>
                        
                            <li >
                                <a href="../../../bundles/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../../bundles/menu/">Menu</a>
                            </li>
                        
                            <li >
                                <a href="../../../bundles/sitemap/">Sitemap</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Book <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../../book/">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/standards/classes/">Classes</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/standards/code/">Code</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/standards/dependency-injection/">Dependency injection</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/standards/packages-structure/">Packages structure</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/workflows/cart/">Cart</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/bundles/extensions/">Extensions</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/bundles/plugins/">Plugins</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/bundles/templates/">Templates</a>
                            </li>
                        
                            <li >
                                <a href="../../../book/philosophy/elcodi/">Elcodi</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../caveats/test-suite/">Test suite</a>
                            </li>
                        
                            <li >
                                <a href="../../installation/dependent-bundles/">Dependent bundles</a>
                            </li>
                        
                            <li >
                                <a href="../../overwrite/entity/">Entity</a>
                            </li>
                        
                            <li >
                                <a href="../../overwrite/parameter/">Parameter</a>
                            </li>
                        
                            <li >
                                <a href="../../overwrite/service/">Service</a>
                            </li>
                        
                            <li >
                                <a href="../controller-command/">Controller command</a>
                            </li>
                        
                            <li >
                                <a href="../entity/">Entity</a>
                            </li>
                        
                            <li class="active">
                                <a href="./">Factory</a>
                            </li>
                        
                            <li >
                                <a href="../form-type/">Form type</a>
                            </li>
                        
                            <li >
                                <a href="../repository/">Repository</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../entity/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../form-type/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#how-to-implement-a-factory">How to Implement a Factory</a></li>
        
            <li><a href="#factory-as-a-service">Factory as a service</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="how-to-implement-a-factory">How to Implement a Factory</h1>
<p>Factories usage is one of the most distinctive things in Elcodi architecture
style. Every single entity in Elcodi ecosystem is created using its own Factory,
so by default, an entity should never define its own construction state.</p>
<p>We strongly believe that an entity is not responsible of how it should be created,
so the factory holds this responsibility. This means that an entity should never
implement the <code>__construct()</code> method and it should never initialize any variable.</p>
<p>Because in Elcodi all entity namespaces are defined by a parameter, any factory
must use these parameters to create an instance.</p>
<pre><code class="php">use Elcodi\Component\Language\Entity\Interfaces\LanguageInterface;

/**
 * Class LanguageFactory
 */
class LanguageFactory extends AbstractFactory
{
    /**
     * @var string
     *
     * Entity namespace
     */
    protected $entityNamespace;

    /**
     * Set Entity Namespace
     *
     * @param string $entityNamespace Entity namespace
     *
     * @return $this Self object
     */
    public function setEntityNamespace($entityNamespace)
    {
        $this-&gt;entityNamespace = $entityNamespace;

        return $this;
    }

    /**
     * Creates an instance of a simple language.
     *
     * This method must return always an empty instance for related entity
     *
     * @return LanguageInterface Empty entity
     */
    public function create()
    {
        /**
         * @var LanguageInterface $language
         */
        $classNamespace = $this-&gt;getEntityNamespace();
        $language = new $classNamespace();

        $language-&gt;setEnabled(false);

        return $language;
    }
}
</code></pre>

<p>As you can see, the namespace is injected, and when the factory creates the 
instance, uses this namespace. With this strategy, the factory becomes uncoupled
from the entity implementation.</p>
<p>In order to make things easier, there is a Trait in package <code>elcodi/core</code>, 
designed to be an abstraction of a Factory. Extending this abstract class, you
can access to <code>$this-&gt;getEntityNamespace()</code>.</p>
<pre><code class="php">use Elcodi\Component\Core\Factory\Abstracts\AbstractFactory;
use Elcodi\Component\Language\Entity\Interfaces\LanguageInterface;

/**
 * Class LanguageFactory
 */
class LanguageFactory extends AbstractFactory
{
    /**
     * Creates an instance of a simple language.
     *
     * This method must return always an empty instance for related entity
     *
     * @return LanguageInterface Empty entity
     */
    public function create()
    {
        /**
         * @var LanguageInterface $language
         */
        $classNamespace = $this-&gt;getEntityNamespace();
        $language = new $classNamespace();

        $language-&gt;setEnabled(false);

        return $language;
    }
}
</code></pre>

<h3 id="factory-as-a-service">Factory as a service</h3>
<p>Because the factory dependencies need to be resolved, we must define the factory
as a service.</p>
<pre><code class="yaml">services:

    #
    # Factory for entity language
    #
    elcodi.factory.language:
        class: %elcodi.factory.language.class%
        calls:
            - [setEntityNamespace, [&quot;%elcodi.entity.language.class%&quot;]]
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>

        <!--
        MkDocs version  : 0.12.1
        Docs Build Date : 2015-05-21 16:35:28.704596
        -->
    </body>
</html>